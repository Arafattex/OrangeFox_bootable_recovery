<?xml version="1.0"?>
<recovery>
	<pages>
		<!-- Customization -->
		<page name="ext_custom">
			<template name="body"/>

			<template name="ab"/>

			<template name="statusbarinfo"/>

			<text style="text_ab_title">
				<placement x="%col1_x_indent%" y="%ab_bc_y%"/>
				<text>{@settings_ui}</text>
			</text>

			<!-- Navbar -->
			<button style="bs_btn">
				<placement x="0" y="%set_row1_y%" w="%screen_w%" h="%ab_menu_sort_btn_h%"/>
				<action function="page">ext_custom_nav</action>
			</button>
			
			<image>
				<placement x="%col1_x%" y="%set_row1_y%"/>
				<image resource="nav"/>
			</image>
			
			<text style="bs_text">
				<placement x="%col1_x_indent%" y="%set_row1_text_y%"/>
				<text>{@navbar_title}</text>
			</text>
			<!-- -->

			<!-- Statusbar -->
			<button style="bs_btn">
				<placement x="0" y="%set_row2_y%" w="%screen_w%" h="%ab_menu_sort_btn_h%"/>
				<action function="page">ext_custom_status</action>
			</button>
			
			<image>
				<placement x="%col1_x%" y="%set_row2_y%"/>
				<image resource="statusbar"/>
			</image>
			
			<text style="bs_text">
				<placement x="%col1_x_indent%" y="%set_row2_text_y%"/>
				<text>{@settings_ui_status}</text>
			</text>
			<!-- -->

			<!-- Lockscreen -->
			<button style="bs_btn">
				<placement x="0" y="%set_row3_y%" w="%screen_w%" h="%ab_menu_sort_btn_h%"/>
				<action function="page">ext_custom_lock</action>
			</button>
			
			<image>
				<placement x="%col1_x%" y="%set_row3_y%"/>
				<image resource="lockscreen"/>
			</image>
			
			<text style="bs_text">
				<placement x="%col1_x_indent%" y="%set_row3_text_y%"/>
				<text>{@lockscreen_title}</text>
			</text>
			<!-- -->

			<!-- Keyboard -->
			<button style="bs_btn">
				<placement x="0" y="%set_row4_y%" w="%screen_w%" h="%ab_menu_sort_btn_h%"/>
				<action function="page">ext_custom_key</action>
			</button>
			
			<image>
				<placement x="%col1_x%" y="%set_row4_y%"/>
				<image resource="keyboard"/>
			</image>
			
			<text style="bs_text">
				<placement x="%col1_x_indent%" y="%set_row4_text_y%"/>
				<text>{@keyboard_title}</text>
			</text>
			<!-- -->

			<!-- Theme -->
			<button style="bs_btn">
				<placement x="0" y="%set_row5_y%" w="%screen_w%" h="%ab_menu_sort_btn_h%"/>
				<action function="page">ext_custom_theme</action>
			</button>
			
			<image>
				<placement x="%col1_x%" y="%set_row5_y%"/>
				<image resource="invert"/>
			</image>
			
			<text style="bs_text">
				<placement x="%col1_x_indent%" y="%set_row5_text_y%"/>
				<text>Theme</text>
			</text>
			<!-- -->

			<!-- Fonts -->
			<button style="bs_btn">
				<placement x="0" y="%set_row6_y%" w="%screen_w%" h="%ab_menu_sort_btn_h%"/>
				<action function="page">ext_custom_fonts</action>
			</button>
			
			<image>
				<placement x="%col1_x%" y="%set_row6_y%"/>
				<image resource="ws_font"/>
			</image>
			
			<text style="bs_text">
				<placement x="%col1_x_indent%" y="%set_row6_text_y%"/>
				<text>{@theme_fonts}</text>
			</text>
			<!-- -->
			
			<template name="snackbar_update"/>
			
			<action>
				<touch key="home"/>
				<action function="page">main</action>
			</action>

			<action>
				<touch key="back"/>
				<action function="page">settings</action>
			</action>
		</page>

		<!-- Statusbar -->
		<page name="ext_custom_status">
			<template name="body"/>

			<template name="ab"/>

			<template name="statusbarinfo"/>

			<text style="text_ab_title">
				<placement x="%col1_x_indent%" y="%ab_bc_y%"/>
				<text>{@settings_ui_status}</text>
			</text>

			<text style="caption">
				<placement x="%col1_x%" y="%row1_1_y%"/>
				<text>{@status_clock_pos}</text>
			</text>

			<listbox>
				<placement x="0" y="%row1_2_y%" w="%screen_w%" h="%lb_l3%"/>
				<data name="center_clock"/>
				<listitem name="{@status_clock_left}">2</listitem>
				<listitem name="{@status_clock_center}">1<condition var1="cutout_clock" var2="0"/></listitem>
				<listitem name="{@status_clock_right}">0<condition var1="cutout_clock" op="&lt;=" var2="1"/></listitem>
			</listbox>

			<text style="caption">
				<placement x="%col1_x%" y="%row4_3a_y%"/>
				<text>{@settings_ui_status}</text>
			</text>

			<listbox style="settingslist">
				<placement x="0" y="%row5_1a_y%" w="%screen_w%" h="%lb_l4%"/>
				<listitem name="{@dark_title}">
					<data variable="darker_ui"/>
				</listitem>
				<listitem name="{@noshadow_title}">
					<data variable="flat_tbar"/>
				</listitem>
				<listitem name="{@hide_notch}">
					<data variable="hide_notch"/>
					<condition var1="allow_hide_notch" var2="1"/>
				</listitem>
				<listitem name="{@separate_status}">
					<data variable="separate_status"/>
				</listitem>
				<listitem name="{@show_cpu_temp_bar}">
					<data variable="show_cpu_temp"/>
					<condition var1="center_clock" op="!=" var2="2"/>
				</listitem>
				<listitem name="{@settings_ui_battery}">
					<data variable="enable_battery"/>
				</listitem>
			</listbox>

			<text style="caption">
				<placement x="%col1_x%" y="%row3_1a_y%"/>
				<text>Battery icon</text>
			</text>

			<listbox>
				<placement x="0" y="%row3_2a_y%" w="%screen_w%" h="%lb_l2%"/>
				<data name="style_battery"/>
				<listitem name="Pie">2</listitem>
				<listitem name="Circle">1</listitem>
			</listbox>

			<action>
				<touch key="home"/>
				<action function="page">main</action>
			</action>

			<action>
				<touch key="back"/>
				<action function="page">ext_custom</action>
			</action>
		</page>

		<!-- Keyboard -->
		<page name="ext_custom_key">
			<template name="body_key"/>
			
			<fill color="%accent%">
				<condition var1="key_buttons" var2="1"/>
				<placement x="0" y="%ab_h%" w="%screen_w%" h="%ab_btn_h%"/>
			</fill>
			
			<fill color="%unactive_title%">
				<condition var1="key_buttons" op="!=" var2="1"/>
				<placement x="0" y="%ab_h%" w="%screen_w%" h="%ab_btn_h%"/>
			</fill>

			<image>
				<condition var1="key_buttons" var2="1"/>
				<placement x="%ab_btn1_x%" y="%ab2_y%"/>
				<image resource="switch_on"/>
			</image>
			<image>
				<condition var1="key_buttons" op="!=" var2="1"/>
				<placement x="%ab_btn1_x%" y="%ab2_y%"/>
				<image resource="switch_off"/>
			</image>

			<text style="text_ab_switch">
				<placement x="%col1_x_indent%" y="%ab_bc2_y%"/>
				<text>{@keyboard_newstyle}</text>
			</text>

			<button style="bs_btn">
				<condition var1="key_buttons" op="!=" var2="1"/>
				<placement x="0" y="%ab_h%" w="%screen_w%" h="%ab_btn_h%"/>
				<actions>
					<action function="set">key_buttons=1</action>
				</actions>
			</button>
			
			<button style="bs_btn">
				<condition var1="key_buttons" var2="1"/>
				<placement x="0" y="%ab_h%" w="%screen_w%" h="%ab_btn_h%"/>
				<actions>
					<action function="set">key_buttons=0</action>
				</actions>
			</button>

			<template name="ab"/>

			<template name="statusbarinfo"/>

			<text style="text_ab_title">
				<placement x="%col1_x_indent%" y="%ab_bc_y%"/>
				<text>{@keyboard_title}</text>
			</text>

			<listbox style="settingslist">
				<placement x="0" y="%row1_3a_y%" w="%screen_w%" h="%lb_l1%"/>
				<listitem name="{@keyboard_nums}">
					<data variable="xxx"/>
				</listitem>
			</listbox>

			<action>
				<touch key="home"/>
				<action function="page">main</action>
			</action>

			<action>
				<touch key="back"/>
				<action function="page">ext_custom</action>
			</action>
		</page>

		<!-- Lockscreen -->
		<page name="ext_custom_lock">
			<template name="body"/>

			<template name="ab"/>

			<template name="statusbarinfo"/>

			<text style="text_ab_title">
				<placement x="%col1_x_indent%" y="%ab_bc_y%"/>
				<text>{@lockscreen_title}</text>
			</text>

			<!-- Lockscreen preview -->
			<image>
				<condition var1="clock_style" var2="0"/>
				<image resource="unlock_icon"/>
				<placement x="%center_x%" y="%row2_2_y%" placement="4"/>
			</image>

			<text color="%text%">
				<condition var1="clock_style" var2="1"/>
				<font resource="clock"/>
				<placement x="%center_x%" y="%row2_1_y%" placement="4"/>
				<text>%tw_time%</text>
			</text>

			<text color="%text%">
				<condition var1="clock_style" var2="1"/>
				<condition var1="lock_info" var2="1"/>
				<font resource="info"/>
				<placement x="%center_x%" y="%row2_3a_y%" placement="4"/>
				<text>{@cpu_temp} | %tw_battery%</text>
			</text>
			<!-- -->

			<image>
				<image resource="actionbar_shadow"/>
				<condition var1="flat_tbar" op="!=" var2="1"/>
				<placement x="0" y="%row4_1_y%"/>
			</image>

			<text style="caption">
				<placement x="%col1_x%" y="%row4_2_y%"/>
				<text>{@lockscreen_style}</text>
			</text>

			<listbox>
				<placement x="0" y="%row4_3_y%" w="%row2_1_y%" h="%lb_l3%"/>
				<data name="clock_style"/>
				<listitem name="{@lockscreen_icon}">0</listitem>
				<listitem name="{@lockscreen_clock}">1</listitem>
			</listbox>

			<text style="caption">
				<placement x="%col1_x%" y="%row6_1_y%"/>
				<text>{@cust_oth}</text>
			</text>

			<listbox style="settingslist">
				<placement x="0" y="%row6_2_y%" w="%screen_w%" h="%lb_l5%"/>
				<listitem name="{@lockscreen_info}">
					<condition var1="clock_style" var2="1"/>
					<data variable="lock_info"/>
				</listitem>
				<listitem name="{@lockscreen_quicklock}">
					<condition var1="clock_style" var2="0"/>
					<data variable="lock_action"/>
				</listitem>
				<listitem name="{@lockscreen_btn}">
					<data variable="lock_btn"/>
				</listitem>
			</listbox>

			<action>
				<touch key="home"/>
				<action function="page">main</action>
			</action>

			<action>
				<touch key="back"/>
				<action function="page">ext_custom</action>
			</action>
		</page>

		<page name="ext_custom_nav">
			<template name="body"/>

			<fill color="%accent%">
				<condition var1="navbar_disable" var2="0"/>
				<placement x="0" y="%ab_h%" w="%screen_w%" h="%ab_btn_h%"/>
			</fill>
			<fill color="%unactive_title%">
				<condition var1="navbar_disable" var2="1"/>
				<placement x="0" y="%ab_h%" w="%screen_w%" h="%ab_btn_h%"/>
			</fill>

			<image>
				<condition var1="navbar_disable" var2="1"/>
				<placement x="%ab_btn1_x%" y="%ab2_y%"/>
				<image resource="switch_off"/>
			</image>
			
			<image>
				<condition var1="navbar_disable" op="!=" var2="1"/>
				<placement x="%ab_btn1_x%" y="%ab2_y%"/>
				<image resource="switch_on"/>
			</image>

			<text style="text_ab_switch">
				<placement x="%col1_x_indent%" y="%ab_bc2_y%"/>
				<text>{@navbar_onscreen}</text>
			</text>

			<button style="bs_btn">
				<condition var1="navbar_disable" op="!=" var2="1"/>
				<placement x="0" y="%ab_h%" w="%screen_w%" h="%ab_btn_h%"/>
				<actions>
					<action function="set">navbar_disable=1</action>
					<action function="set">navbar_disable_add=144</action>
					<action function="set">needs_repack=1</action>
					<action function="set">update_navbar=1</action>
				</actions>
			</button>

			<button style="bs_btn">
				<condition var1="navbar_disable" var2="1"/>
				<placement x="0" y="%ab_h%" w="%screen_w%" h="%ab_btn_h%"/>
				<actions>
					<action function="set">navbar_disable=0</action>
					<action function="set">navbar_disable_add=0</action>
					<action function="set">needs_repack=1</action>
					<action function="set">update_navbar=1</action>
				</actions>
			</button>

			<template name="ab"/>

			<template name="statusbarinfo"/>

			<text style="text_ab_title">
				<placement x="%col1_x_indent%" y="%ab_bc_y%"/>
				<text>{@navbar_title}</text>
			</text>

			<text style="caption">
				<placement x="%col1_x%" y="%row1_3a_y%"/>
				<condition var1="navbar_disable" op="!=" var2="1"/>
				<text>{@settings_ui_style}</text>
			</text>

			<listbox>
				<placement x="0" y="%row2_1a_y%" w="%screen_w%" h="%lb_l3%"/>
				<condition var1="navbar_disable" op="!=" var2="1"/>
				<data name="nougat"/>
				<listitem name="{@cust_navbar_cls}">0</listitem>
				<listitem name="{@cust_navbar_noug}">1</listitem>
				<listitem name="Pie">3</listitem>
			</listbox>

			<text style="caption">
				<placement x="%col1_x%" y="%row4_1_y%"/>
				<condition var1="navbar_disable" op="!=" var2="1"/>
				<text>{@settings_ui_color}</text>
			</text>

			<listbox>
				<placement x="0" y="%row4_2_y%" w="%screen_w%" h="%lb_l4%"/>
				<condition var1="navbar_disable" op="!=" var2="1"/>
				<data name="navbar_bkg"/>
				<listitem name="{@fm_none}">0</listitem>
				<listitem name="{@dark_nav}">3</listitem>
				<listitem name="{@cust_navbar_accent}">1</listitem>
				<listitem name="{@cust_navbar_black}">2<condition var1="theme_style" op="!=" var2="Black"/>
				</listitem>
			</listbox>

			<text style="caption">
				<placement x="%col1_x%" y="%row6_3_y%"/>
				<condition var1="navbar_disable" op="!=" var2="1"/>
				<text>{@cust_oth}</text>
			</text>

			<listbox style="settingslist">
				<placement x="0" y="%row7_1_y%" w="%screen_w%" h="%lb_l3%"/>
				<condition var1="navbar_disable" op="!=" var2="1"/>
				<listitem name="{@cust_navbar_white}">
					<condition var1="navbar_bkg" op="!=" var2="1"/>
					<condition var1="theme_style_main" op="!=" var2="Light"/>
					<data variable="navbar_accent"/>
				</listitem>
				<listitem name="{@cust_navbar_white}">
					<condition var1="navbar_bkg" op="!=" var2="1"/>
					<condition var1="nougat" op="!=" var2="3"/>
					<condition var1="theme_style_main" var2="Light"/>
					<condition var1="theme_background" var2="on"/>
					<data variable="navbar_accent"/>
				</listitem>
				<listitem name="{@cust_navbar_white}">
					<condition var1="navbar_bkg" var2="2"/>
					<condition var1="theme_style_main" var2="Light"/>
					<data variable="navbar_accent"/>
				</listitem>
				<listitem name="{@rev_navbar_chk}">
					<data variable="navbar_sams"/>
				</listitem>
				<listitem name="{@show_slideout}">
					<data variable="show_slideout"/>
				</listitem>
			</listbox>

			<action>
				<condition var1="navbar_bkg" var2="1"/>
				<condition var1="navbar_accent" var2="0"/>
				<action function="set">navbar_accent=1</action>
			</action>

			<template name="snackbar_update"/>

			<action>
				<touch key="home"/>
				<action function="page">main</action>
			</action>

			<action>
				<touch key="back"/>
				<action function="page">ext_custom</action>
			</action>
		</page>

		<!-- WorkShop by fordownloads -->
		<page name="ext_custom_fonts">
			<template name="body"/>
			
			<template name="ab"/>
			
			<template name="statusbarinfo"/>
			
			<text style="text_ab_title">
				<placement x="%col1_x_indent%" y="%ab_bc_y%"/>
				<text>{@theme_fonts}</text>
			</text>
			
			<text style="caption">
				<placement x="%col1_x%" y="%row1_1_y%" />
				<text>{@theme_font_sel}</text>
			</text>
			
			<text style="caption">
				<placement x="%col2_x_text%" y="%row1_1_y%"/>
				<text>{@theme_sec_font_sel}</text>
			</text>
			
			<listbox>
				<placement x="0" y="%row1_2_y%" w="%listbox_tz_width_2%" h="%lb_l1%"/>
				<font resource="font1" spacing="%fileselector_spacing%" color="%text%" />
				<data name="theme_font"/>
				<listitem name="Roboto">Roboto</listitem>
			</listbox>
			
			<listbox>
				<placement x="0" y="%row1_3a_y%" w="%listbox_tz_width_2%" h="%lb_l1%"/>
				<font resource="font2" spacing="%fileselector_spacing%" color="%text%" />
				<data name="theme_font"/>
				<listitem name="Roboto Slab">RobotoSlab</listitem>
			</listbox>
			
			<listbox>
				<placement x="0" y="%row2_2_y%" w="%listbox_tz_width_2%" h="%lb_l1%"/>
				<font resource="font3" spacing="%fileselector_spacing%" color="%text%" />
				<data name="theme_font"/>
				<listitem name="Google Sans">GoogleSans</listitem>
			</listbox>
			
			<listbox>
				<placement x="0" y="%row2_3a_y%" w="%listbox_tz_width_2%" h="%lb_l1%"/>
				<font resource="font4" spacing="%fileselector_spacing%" color="%text%" />
				<data name="theme_font"/>
				<listitem name="Samsung Sans">SamsungSans</listitem>
			</listbox>
			
			<listbox>
				<placement x="0" y="%row3_2_y%" w="%listbox_tz_width_2%" h="%lb_l1%"/>
				<font resource="font5" spacing="%fileselector_spacing%" color="%text%" />
				<data name="theme_font"/>
				<listitem name="Choco Cooky">Chococooky</listitem>
			</listbox>
			
			<listbox>
				<placement x="0" y="%row3_3a_y%" w="%listbox_tz_width_2%" h="%lb_l1%"/>
				<font resource="font6" spacing="%fileselector_spacing%" color="%text%" />
				<data name="theme_font"/>
				<listitem name="Cool Jazz">Cooljazz</listitem>
			</listbox>
			
			<listbox>
				<placement x="0" y="%row4_2_y%" w="%listbox_tz_width_2%" h="%lb_l1%"/>
				<font resource="font7" spacing="%fileselector_spacing%" color="%text%" />
				<data name="theme_font"/>
				<listitem name="Bender">Bender</listitem>
			</listbox>
			
			<listbox>
				<placement x="0" y="%row4_3a_y%" w="%listbox_tz_width_2%" h="%lb_l1%"/>
				<font resource="font8" spacing="%fileselector_spacing%" color="%text%" />
				<data name="theme_font"/>
				<listitem name="Amatic">Amatic</listitem>
			</listbox>
			
			<listbox>
				<placement x="0" y="%row5_2_y%" w="%listbox_tz_width_2%" h="%lb_l1%"/>
				<font resource="font9" spacing="%fileselector_spacing%" color="%text%" />
				<data name="theme_font"/>
				<listitem name="Angry Birds">AngryBirds</listitem>
			</listbox>
			
			<listbox>
				<placement x="%col2_x%" y="%row1_2_y%" w="%listbox_tz_width_2%" h="%lb_l1%"/>
				<font resource="font1" spacing="%fileselector_spacing%" color="%text%" />
				<data name="theme_sec_font"/>
				<listitem name="Roboto">Roboto</listitem>
			</listbox>
			
			<listbox>
				<placement x="%col2_x%" y="%row1_3a_y%" w="%listbox_tz_width_2%" h="%lb_l1%"/>
				<font resource="font2" spacing="%fileselector_spacing%" color="%text%" />
				<data name="theme_sec_font"/>
				<listitem name="Roboto Slab">RobotoSlab</listitem>
			</listbox>
			
			<listbox>
				<placement x="%col2_x%" y="%row2_2_y%" w="%listbox_tz_width_2%" h="%lb_l1%"/>
				<font resource="font3" spacing="%fileselector_spacing%" color="%text%" />
				<data name="theme_sec_font"/>
				<listitem name="Google Sans">GoogleSans</listitem>
			</listbox>
			
			<listbox>
				<placement x="%col2_x%" y="%row2_3a_y%" w="%listbox_tz_width_2%" h="%lb_l1%"/>
				<font resource="font4" spacing="%fileselector_spacing%" color="%text%" />
				<data name="theme_sec_font"/>
				<listitem name="Samsung Sans">SamsungSans</listitem>
			</listbox>
			
			<listbox>
				<placement x="%col2_x%" y="%row3_2_y%" w="%listbox_tz_width_2%" h="%lb_l1%"/>
				<font resource="font5" spacing="%fileselector_spacing%" color="%text%" />
				<data name="theme_sec_font"/>
				<listitem name="Choco Cooky">Chococooky</listitem>
			</listbox>
			
			<listbox>
				<placement x="%col2_x%" y="%row3_3a_y%" w="%listbox_tz_width_2%" h="%lb_l1%"/>
				<font resource="font6" spacing="%fileselector_spacing%" color="%text%" />
				<data name="theme_sec_font"/>
				<listitem name="Cool Jazz">Cooljazz</listitem>
			</listbox>
			
			<listbox>
				<placement x="%col2_x%" y="%row4_2_y%" w="%listbox_tz_width_2%" h="%lb_l1%"/>
				<font resource="font7" spacing="%fileselector_spacing%" color="%text%" />
				<data name="theme_sec_font"/>
				<listitem name="Bender">Bender</listitem>
			</listbox>
			
			<listbox>
				<placement x="%col2_x%" y="%row4_3a_y%" w="%listbox_tz_width_2%" h="%lb_l1%"/>
				<font resource="font8" spacing="%fileselector_spacing%" color="%text%" />
				<data name="theme_sec_font"/>
				<listitem name="Amatic">Amatic</listitem>
			</listbox>
			
			<listbox>
				<placement x="%col2_x%" y="%row5_2_y%" w="%listbox_tz_width_2%" h="%lb_l1%"/>
				<font resource="font9" spacing="%fileselector_spacing%" color="%text%" />
				<data name="theme_sec_font"/>
				<listitem name="Angry Birds">AngryBirds</listitem>
			</listbox>
			
			<!--button style="btn_raised">
				<condition var1="theme_font" op="!=" var2="Custom"/>
				<placement x="%btn_raised_right_x%" y="%row_btn1_y%" placement="1"/>
				<text>{@custom_font}</text>
				<action function="page">ext_custom_fonts_cust</action>
			</button>
			
			<button style="btn_raised_hl">
				<condition var1="theme_font" var2="Custom"/>
				<placement x="%btn_raised_right_x%" y="%row_btn1_y%" placement="1"/>
				<text>{@custom_font}</text>
				<action function="page">ext_custom_fonts_cust</action>
			</button-->
			
			<action>
				<condition var1="theme_font" op="modified"/>
				<action function="set">needs_repack=1</action>
				<action function="set">update_fonts=1</action>
			</action>
			
			<action>
				<condition var1="theme_sec_font" op="modified"/>
				<action function="set">needs_repack=1</action>
				<action function="set">update_fonts=1</action>
			</action>

			<!-- Font Size -->
			<text style="caption">
				<placement x="%col1_x%" y="%row6_1_y%" />
				<text>Font size</text>
			</text>

			<listbox>
				<placement x="0" y="%row6_2_y%" w="%screen_w%" h="%lb_l2%"/>
				<data name="theme_font_size"/>
				<listitem name="Normal">n</listitem>
				<listitem name="Small">s</listitem>
			</listbox>

			<action>
				<condition var1="theme_font_size" op="modified"/>
				<action function="set">needs_repack=1</action>
				<action function="set">update_fonts=1</action>
			</action>

			<template name="snackbar_update"/>

			<action>
				<touch key="home"/>
				<action function="page">main</action>
			</action>
			
			<action>
				<touch key="back"/>
				<action function="page">ext_custom</action>
			</action>
		</page>
		
		<page name="ext_custom_fonts_cust">
			<template name="body"/>
			
			<fileselector style="fileselector_b">
				<condition var1="list_font" var2="1"/>
				<placement x="0" y="%row_ab_ex_y%" w="%fileselector_width%" h="%fileselector_terminal_height%"/>
				<sort name="tw_gui_sort_order"/>
				<icon folder="folder_icon" file="file_icon" />
				<filter extn=".ttf" folders="1" files="1"/>
				<path name="tw_zip_location" default="/sdcard"/>
				<data name="tw_filename"/>
				<selection name="tw_file"/>
			</fileselector>

			<fileselector style="fileselector_s">
				<condition var1="list_font" op="!=" var2="1"/>
				<placement x="0" y="%row_ab_ex_y%" w="%fileselector_width%" h="%fileselector_terminal_height%"/>
				<sort name="tw_gui_sort_order"/>
				<icon folder="folder_icon_small" file="file_icon_small" />
				<filter extn=".ttf" folders="1" files="1"/>
				<path name="tw_zip_location" default="/sdcard"/>
				<data name="tw_filename"/>
				<selection name="tw_file"/>
			</fileselector>

			<template name="find_file"/>

			<text style="text_ab_title">
				<placement x="%col1_x_indent%" y="%ab_bc_y%"/>
				<text>{@theme_fonts}</text>
			</text>

			<text style="text_ab_title">
				<placement x="%col1_x_indent%" y="%row1_2_y%" placement="2"/>
				<text>{@select_custom_font}</text>
			</text>

			<action>
				<condition var1="tw_filename" op="modified"/>
				<actions>
					<action function="set">ttf_path=%tw_filename%</action>
					<action function="set">theme_cmd=themes/fonts/Custom.xml > ./themes/font.xml;cp "%ttf_path%" "./fonts/Custom.ttf"</action>
					<action function="page">apply_font</action>
				</actions>
			</action>

			<action>
				<touch key="back"/>
				<action function="page">ext_custom_fonts</action>
			</action>

			<action>
				<touch key="home"/>
				<action function="page">main</action>
			</action>
		</page>
		
		<page name="ext_custom_theme">
			<template name="body"/>
			
			<template name="ab"/>
			
			<template name="statusbarinfo"/>
			
			<text style="text_ab_title">
				<placement x="%col1_x_indent%" y="%ab_bc_y%"/>
				<text>Theme</text>
			</text>
			
			<text style="caption">
				<placement x="%col1_x%" y="%row1_1_y%" />
				<text>{@theme_style}</text>
			</text>

			<!-- Themes -->
			<!-- Black -->
			<button>
				<placement x="30" y="360"/>
				<condition var1="theme_accent" op="!=" var2="Black"/>
				<image resource="style_gray"/>
				<action function="set">theme_style=Gray</action>
			</button>
			
			<button>
				<placement x="30" y="360"/>
				<condition var1="theme_accent" var2="Black"/>
				<image resource="style_gray"/>
				<action function="set">theme_style=Gray</action>
				<action function="set">theme_accent=Gray</action>
			</button>

			<image>
				<placement x="30" y="360"/>
				<condition var1="theme_style" var2="Gray"/>
				<image resource="style_apply"/>
			</image>
			<!-- -->

			<!-- Gray -->
			<button>
				<placement x="285" y="360"/>
				<condition var1="theme_accent" op="!=" var2="Black"/>
				<image resource="style_black"/>
				<action function="set">theme_style=Black</action>
			</button>
			
			<button>
				<placement x="285" y="360"/>
				<condition var1="theme_accent" var2="Black"/>
				<image resource="style_black"/>
				<action function="set">theme_style=Black</action>
				<action function="set">theme_accent=Gray</action>
			</button>

			<image>
				<placement x="285" y="360"/>
				<condition var1="theme_style" var2="Black"/>
				<image resource="style_apply"/>
			</image>
			<!-- -->

			<!-- Light -->
			<button>
				<placement x="540" y="360"/>
				<condition var1="theme_accent" op="!=" var2="Gray"/>
				<image resource="style_light"/>
				<action function="set">theme_style=Light</action>
			</button>
			
			<button>
				<placement x="540" y="360"/>
				<condition var1="theme_accent" var2="Gray"/>
				<image resource="style_light"/>
				<action function="set">theme_style=Light</action>
				<action function="set">theme_accent=Black</action>
			</button>

			<image>
				<placement x="540" y="360"/>
				<condition var1="theme_style" var2="Light"/>
				<image resource="style_apply_black"/>
			</image>
			<!-- -->

			<!-- Light classic -->
			<button>
				<placement x="795" y="360"/>
				<condition var1="theme_accent" op="!=" var2="Black"/>
				<image resource="style_light_c"/>
				<action function="set">theme_style=Light_classic</action>
			</button>
			
			<button>
				<placement x="795" y="360"/>
				<condition var1="theme_accent" var2="Black"/>
				<image resource="style_light_c"/>
				<action function="set">theme_style=Light_classic</action>
				<action function="set">theme_accent=Gray</action>
			</button>
			
			<image>
				<placement x="795" y="360"/>
				<condition var1="theme_style" var2="Light_classic"/>
				<image resource="style_apply"/>
			</image>
			<!-- -->

			<!-- Accent colors -->
			<text style="caption">
				<placement x="%col1_x%" y="%row3_1_y%" />
				<text>{@theme_accent}</text>
			</text>

			<!-- Orange -->
			<button>
				<placement x="30" y="720"/>
				<image resource="color_fox"/>
				<action function="set">theme_accent=Orange</action>
			</button>

			<image>
				<condition var1="theme_accent" var2="Orange"/>
				<placement x="30" y="720"/>
				<image resource="style_apply"/>
			</image>
			<!-- -->

			<!-- Blue -->
			<button>
				<placement x="285" y="720"/>
				<image resource="color_blue"/>
				<action function="set">theme_accent=Blue</action>
			</button>

			<image>
				<condition var1="theme_accent" var2="Blue"/>
				<placement x="285" y="720"/>
				<image resource="style_apply"/>
			</image>
			<!-- -->
			
			<!-- Teal -->
			<button>
				<placement x="540" y="720"/>
				<image resource="color_cyan"/>
				<action function="set">theme_accent=Teal</action>
			</button>

			<image>
				<condition var1="theme_accent" var2="Teal"/>
				<placement x="540" y="720"/>
				<image resource="style_apply"/>
			</image>
			<!-- -->

			<!-- Black / Gray (based on selected theme) -->
			<button>
				<condition var1="theme_style" op="!=" var2="Light"/>
				<placement x="795" y="720"/>
				<image resource="color_gray"/>
				<action function="set">theme_accent=Gray</action>
			</button>

			<button>
				<condition var1="theme_style" var2="Light"/>
				<placement x="795" y="720"/>
				<image resource="style_black"/>
				<action function="set">theme_accent=Black</action>
			</button>

			<image>
				<condition var1="theme_accent" var2="Gray"/>
				<condition var1="theme_style" op="!=" var2="Light"/>
				<placement x="795" y="720"/>
				<image resource="style_apply"/>
			</image>

			<image>
				<condition var1="theme_accent" var2="Black"/>
				<condition var1="theme_style" var2="Light"/>
				<placement x="795" y="720"/>
				<image resource="style_apply"/>
			</image>
			<!-- -->

			<!-- Red -->
			<button>
				<placement x="30" y="975"/>
				<image resource="color_red"/>
				<action function="set">theme_accent=Red</action>
			</button>

			<image>
				<condition var1="theme_accent" var2="Red"/>
				<placement x="30" y="975"/>
				<image resource="style_apply"/>
			</image>
			<!-- -->

			<!-- Indigo -->
			<button>
				<placement x="285" y="975"/>
				<image resource="color_indigo"/>
				<action function="set">theme_accent=Indigo</action>
			</button>

			<image>
				<condition var1="theme_accent" var2="Indigo"/>
				<placement x="285" y="975"/>
				<image resource="style_apply"/>
			</image>
			<!-- -->

			<!-- Green -->
			<button>
				<placement x="540" y="975"/>
				<image resource="color_green"/>
				<action function="set">theme_accent=Green</action>
			</button>

			<image>
				<condition var1="theme_accent" var2="Green"/>
				<placement x="540" y="975"/>
				<image resource="style_apply"/>
			</image>
			<!-- -->

			<!-- BlueGray -->
			<button>
				<placement x="795" y="975"/>
				<image resource="color_bluegray"/>
				<action function="set">theme_accent=BlueGray</action>
			</button>

			<image>
				<condition var1="theme_accent" var2="BlueGray"/>
				<placement x="795" y="975"/>
				<image resource="style_apply"/>
			</image>
			<!-- -->

			<!-- Pink -->
			<button>
				<placement x="30" y="1230"/>
				<image resource="color_pink"/>
				<action function="set">theme_accent=Pink</action>
			</button>

			<image>
				<condition var1="theme_accent" var2="Pink"/>
				<placement x="30" y="1230"/>
				<image resource="style_apply"/>
			</image>
			<!-- -->

			<!-- Purple -->
			<button>
				<placement x="285" y="1230"/>
				<image resource="color_purple"/>
				<action function="set">theme_accent=Purple</action>
			</button>

			<image>
				<condition var1="theme_accent" var2="Purple"/>
				<placement x="285" y="1230"/>
				<image resource="style_apply"/>
			</image>
			<!-- -->

			<!-- Amber -->
			<button>
				<placement x="540" y="1230"/>
				<image resource="color_amber"/>
				<action function="set">theme_accent=Amber</action>
			</button>

			<image>
				<condition var1="theme_accent" var2="Amber"/>
				<placement x="540" y="1230"/>
				<image resource="style_apply"/>
			</image>
			<!-- -->

			<!-- Brown -->
			<button>
				<placement x="795" y="1230"/>
				<image resource="color_brown"/>
				<action function="set">theme_accent=Brown</action>
			</button>

			<image>
				<condition var1="theme_accent" var2="Brown"/>
				<placement x="795" y="1230"/>
				<image resource="style_apply"/>
			</image>
			<!-- -->
			
			<action>
				<condition var1="theme_style" op="modified"/>
				<action function="set">needs_repack=1</action>
				<action function="set">update_style=1</action>
			</action>
			
			<action>
				<condition var1="theme_accent" op="modified"/>
				<action function="set">needs_repack=1</action>
				<action function="set">update_accent=1</action>
			</action>

			<template name="snackbar_update"/>
			
			<action>
				<touch key="back"/>
				<action function="page">ext_custom</action>
			</action>

			<action>
				<touch key="home"/>
				<action function="page">main</action>
			</action>
		</page>

		<page name="apply_changes">
			<template name="busy_screen"/>
			
			<action>
				<condition var1="fox_busy" op="!=" var2="1"/>
				<action function="set">fox_busy=1</action>
				<action function="wlfw"/>
				<action function="cmd">
					#Fonts
					if [[ '%update_fonts%' = '1' ]]; then
						if [ -f "/twres/fonts/%theme_sec_font%.ttf" ];
							then sec_med=;
								 sec_reg=;
							else sec_med=-Medium;
								 sec_reg=-Regular;
						fi;
						if [ -f "/twres/fonts/%theme_font%.ttf" ];
							then prim_med=;
								 prim_reg=;
							else prim_med=-Medium;
								 prim_reg=-Regular;
						fi;
						cat "/twres/themes/sed/font_%theme_font_size%.xml" | sed -e "
						s/#PRIMARY_FONT_MED#/%theme_font%${prim_med}/g;
						s/#PRIMARY_FONT_REG#/%theme_font%${prim_reg}/g;
						s/#SECONDARY_FONT_MED#/%theme_sec_font%${sec_med}/g;
						s/#SECONDARY_FONT_REG#/%theme_sec_font%${sec_reg}/g;
						s/#PRIMARY_NAME#/%theme_font%/g;
						s/#SECONDARY_NAME#/%theme_sec_font%/g
						" > /tmp/orangefox/ramdisk/twres/themes/font.xml;
						cat "/tmp/orangefox/ramdisk/twres/themes/font.xml" > /twres/themes/font.xml;
					fi;
				
					#Navbar
					if [[ '%update_navbar%' = '1' ]]; then
						cat "/twres/themes/sed/navbar.xml" | sed -e "
						s/#NAVBAR_DISABLE#/%navbar_disable%/g;
						s/#SCREEN_H#/$(expr %screen_original_h% + %navbar_disable_add%)/g
						" > /tmp/orangefox/ramdisk/twres/themes/navbar.xml;
						cat "/tmp/orangefox/ramdisk/twres/themes/navbar.xml" > /twres/themes/navbar.xml;
					fi;
				
					#Style
					if [[ '%update_style%' = '1' ]]; then
						cat "/twres/themes/styles/%theme_style%.xml" > /tmp/orangefox/ramdisk/twres/themes/style.xml;
						cat "/tmp/orangefox/ramdisk/twres/themes/style.xml" > /twres/themes/style.xml;
					fi;
				
					#Accent
					if [[ '%update_accent%' = '1' ]]; then
						cat "/twres/themes/accent/%theme_accent%.xml" > /tmp/orangefox/ramdisk/twres/themes/accent.xml;
						cat "/tmp/orangefox/ramdisk/twres/themes/accent.xml" > /twres/themes/accent.xml;
					fi;
				</action>
				<action function="wlfx"/>
				<action function="reload"/>
			</action>
		</page>
	</pages>
</recovery>